version: '3.5'

services:
  trophy_nextjs:
    build:
      context: ../
      dockerfile: ./docker/node/Dockerfile
    restart: always
    container_name: trophy_nextjs
    networks:
      - sa_trophy

  trophy_nginx:
    build:
      context: .
      dockerfile: ./nginx/Dockerfile
    restart: always
    container_name: trophy_nginx
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.trophy_nginx.rule=Host(`moderntrophy.loc`)"
      # - "traefik.http.routers.sa_awards.entrypoints=websecure"
      # - "traefik.http.routers.sa_awards.tls=true"
    networks:
      - sa_trophy

networks:
  sa_trophy:
    external: true